{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImages({searchText, page, perPage }) {\n  const response = (\n    await axios.get(`https://pixabay.com/api/`, {\n      params: {\n        key: '45306533-f7c4428500ee3898e492b2a2f',\n        page: page,\n        per_page: perPage,\n        q: searchText,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n      },\n    })\n  ).data;\n  return response;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport \"../css/styles.css\";\n\nconst gallery = document.querySelector('ul.js-gallery');\nconst galleryModal = new SimpleLightbox('ul.js-gallery a', {\n  className: 'js-lightbox',\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function renderGallery(mpdata) {\n  const markup = mpdata\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t<img\n\t\t\tclass=\"gallery-image\"\n\t\t\tsrc=\"${webformatURL}\"\n\t\t\talt=\"${tags}\"\n\t\t\t/>\n    <div class=\"image-stats\">\n  <p>Likes\n${likes}</p>\n  <p> Views<br>${views}</p>\n  <p>Comments<br>${comments}</P>\n  <p>Dowloads<br>${downloads}</P>\n</div>\n\t</a>\n</li>`\n    )\n    .join('');\n    gallery.insertAdjacentHTML('beforeend', markup);\n    galleryModal.refresh();\n  }\n\nexport default class loadmoreButtonSwitcher {\n    constructor(buttonEL, hiddenClass) {\n      this.buttonEL = buttonEL;\n      this.hiddenClass = hiddenClass;\n    }\n  \n    hide() {\n      this.buttonEL.classList.add(this.hiddenClass);\n    }\n  \n    show() {\n      this.buttonEL.classList.remove(this.hiddenClass);\n    }\n  \n    disable() {\n      this.buttonEL.disabled = true;\n    }\n  \n    enable() {\n      this.buttonEL.disabled = false;\n    }\n  }\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport {getImages} from \"./js/pixabay-api\";\nimport {renderGallery} from \"./js/render-functions\";\nimport loadmoreButtonSwitcher from \"./js/render-functions\";\n\nconst refs = {\n  ulGallery: document.querySelector('.js-gallery'),\n  searchForm: document.querySelector('.js-form'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n  loader: document.querySelector('.loader')\n};\n\n  const loadMore = new loadmoreButtonSwitcher(refs.loadMoreBtn, \"is-hidden\");\n  loadMore.hide();\n  refs.searchForm.addEventListener(\"submit\", handleSearch)\n\n  const qParams = {\n    page: 1,\n    perPage: 15,\n    maxPages: 0,\n    searchText: '',\n    orientation: \"horizontal\",\n    safesearch: true\n};\n\nasync function handleSearch (event) {\n  event.preventDefault();\n  refs.ulGallery.innerHTML = \"\";\n  qParams.page = 1;\n  refs.loader.classList.remove('hidden');\n   loadMore.hide();\n\n  qParams.searchText = event.currentTarget.elements.query.value\n    .trim()\n    .toLowerCase();\n\n  if (qParams.searchText === \"\") {\n    refs.loader.classList.add('hidden');\n    iziToast.info({\n    message:'The field cannot be empty!',\n    position: 'topRight',\n    timeout: 2000,\n    });\n   \n    event.currentTarget.reset();\n    return;\n  }\n       \n  try {\n    const images = await getImages(qParams);\n    renderGallery(images.hits);\n\n    if (images.hits.length === 0) {\n      iziToast.error({\n      message: 'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n      timeout: 2000,\n      icon: '',\n    });\n    return;\n  }\n\n  qParams.maxPages = Math.ceil(\n    images.totalHits / qParams.perPage\n  );\n\n    if (qParams.maxPages > 1) {\n      loadMore.show();\n      refs.loadMoreBtn.addEventListener('click', loadMoreHandler);\n\n    } else {\n        loadMore.hide();\n      }\n\n    } catch (error) {\n    iziToast.error({\n      message: `Request failed with: ${error}`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n\n  } finally {\n    event.target.reset();\n    refs.loader.classList.add('hidden');\n  }  \n}\n    \nasync function loadMoreHandler(event) {\n  loadMore.hide();\n  refs.loader.classList.remove('hidden');\n\n  try {\n    const images = await getImages(qParams);\n    renderGallery(images.hits);\n    qParams.page += 1;\n  \n  } catch (error) {\n    iziToast.error({\n      message: `Request failed with: ${error}`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n  \n  } finally {\n    refs.loader.classList.add('hidden');\n    const itemHeight = document\n      .querySelector('.js-gallery')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: itemHeight * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n\n    if (qParams.page === qParams.maxPages) {\n      loadMore.hide();\n      iziToast.info({\n        message: 'We`re sorry, but you`ve reached the end of search results.',\n        position: 'topRight',\n        timeout: 2000,\n        icon: '',\n      });\n      refs.loadMoreBtn.removeEventListener('click', loadMoreHandler);\n    } else {\n      loadMore.show();\n    }\n  }\n}"],"names":["getImages","searchText","page","perPage","axios","gallery","galleryModal","SimpleLightbox","renderGallery","mpdata","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadmoreButtonSwitcher","buttonEL","hiddenClass","refs","loadMore","handleSearch","qParams","event","iziToast","images","loadMoreHandler","error","itemHeight"],"mappings":"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"}